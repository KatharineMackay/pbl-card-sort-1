<!-- PAGE 1: Visual Card Sort with Bins -->
<!DOCTYPE html>
<html lang="en-AU">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Visual Card Sort Activity</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f4f4f4;
    }
    h1, .instructions {
      text-align: center;
    }
    .palette, .icons, .bins {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 30px;
      gap: 10px;
    }
    .colour {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: grab;
    }
    .icon {
      width: 60px;
      height: 60px;
      cursor: grab;
    }
    .bin {
      border: 2px dashed #ccc;
      padding: 10px;
      min-height: 120px;
      min-width: 150px;
      background: #fff;
      text-align: center;
    }
    .bin h3 {
      font-size: 1rem;
    }
    .bin-content {
      min-height: 100px;
    }
    #submit-btn, #reset-btn {
      display: inline-block;
      margin: 10px;
      padding: 14px 24px;
      font-size: 1.2rem;
      cursor: pointer;
    }
    #buttons-container {
      text-align: center;
      margin-bottom: 20px;
    }
    #comments-label, #comments {
      display: block;
      max-width: 90%;
      margin: 0 auto 10px auto;
      font-size: 1.1rem;
    }
    #comments {
      height: 100px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }

    @media (max-width: 768px) {
      .cat-sort {
        display: flex;
        flex-direction: row;
      }
      #comments, #comments-label, #submit-btn {
        font-size: 1rem;
      }

    }


  </style>
</head>
<body>
  <h1>Visual Card Sort</h1>
  <p class="instructions">
    Drag and place <strong>one or more colours</strong> and <strong>symbols</strong> into each bin.<br>
    Then click <em>Next</em> to continue.
  </p>

  <div class="cat-sort">
  <div class="palette" id="palette"></div>
  <div class="icons" id="icons"></div>
  <div class="bins" id="bins"></div>
  </div>

  <label for="comments" id="comments-label">Optional Comments / Feedback:</label>
  <textarea id="comments" placeholder="Write any comments or feedback here..."></textarea>

  <div id="buttons-container">
    <button id="reset-btn" type="button">Reset</button>
    <button onclick="window.location.href='page2.html'" id="submit-btn" type="button">Next</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script>
  const colours = ["green", "blue", "purple", "#f0f", "red", "orange", "yellow", "black", "#888"];
  const bins = ["Recycling", "Metal", "Glass", "E-waste", "Landfill", "Compost", "10c Cans/Bottles", "Soft Plastic"];
  const icons = Array.from({length: 20}, (_, i) => `${i + 1}.png`);

  const palette = document.getElementById("palette");
  const iconsDiv = document.getElementById("icons");
  const binsDiv = document.getElementById("bins");

  // Create colour dots
  colours.forEach(col => {
    const div = document.createElement("div");
    div.className = "colour";
    div.style.background = col;
    div.setAttribute("data-type", "colour");
    div.setAttribute("data-value", col);
    palette.appendChild(div);
  });

  // Create icon images
  icons.forEach(fn => {
    const img = document.createElement("img");
    img.className = "icon";
    img.src = `icons/${fn}`;
    img.alt = fn;
    img.setAttribute("data-type", "icon");
    img.setAttribute("data-value", fn);
    iconsDiv.appendChild(img);
  });

  // Create bins
  bins.forEach(name => {
    const container = document.createElement("div");
    container.className = "bin";
    container.setAttribute("data-name", name);
    container.innerHTML = `<h3>${name}</h3><div class="bin-content"></div>`;
    binsDiv.appendChild(container);

    // Enable sorting in bin content
    Sortable.create(container.querySelector(".bin-content"), {
      group: {
        name: "shared",
        pull: false,
        put: true
      },
      animation: 150,
      onAdd: function (evt) {
        const original = evt.item;
        const clone = original.cloneNode(true);
        clone.classList.remove('sortable-ghost');

        // Put clone in bin, and return original to palette
        evt.to.removeChild(original);
        evt.to.appendChild(clone);
      }
    });
  });

  // Make palette and icons draggable (as sources only)
  Sortable.create(palette, {
    group: {
      name: "shared",
      pull: "clone",
      put: false
    },
    sort: false,
    animation: 150
  });

  Sortable.create(iconsDiv, {
    group: {
      name: "shared",
      pull: "clone",
      put: false
    },
    sort: false,
    animation: 150
  });

  document.getElementById("reset-btn").addEventListener("click", () => {
    document.querySelectorAll(".bin-content").forEach(c => c.innerHTML = "");
    document.getElementById("comments").value = "";
  });

  document.getElementById("next-btn").addEventListener("click", () => {
    const result = {};
    bins.forEach(name => {
      const binContent = document.querySelector(`[data-name="${name}"] .bin-content`);
      const items = [...binContent.children];
      result[name] = {
        colours: [],
        symbols: []
      };
      items.forEach(el => {
        const val = el.getAttribute("data-value");
        const type = el.getAttribute("data-type");
        if (type === "icon") result[name].symbols.push(val);
        else result[name].colours.push(val);
      });
    });

    const comments = document.getElementById("comments").value.trim();
    localStorage.setItem("page1result", JSON.stringify(result));
    localStorage.setItem("page1comments", comments);
    window.location.href = "page2.html";
  });
</script>

</body>
</html>